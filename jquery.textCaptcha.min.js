/*!
* jQuery Text Captcha Plugin
* Copyright (c) 2012 Brian Ray
* Version: 0.1 (19-AUG-2012)
* Dual licensed under the MIT and GPL licenses.
* Requires: jQuery v1.4.2 or later
*/
(function($){function log(){window.console&&console.log&&console.log("[captcha] "+Array.prototype.join.call(arguments," "))}var ver="0.1";$.fn.textCaptcha=function(a){var b={type:"text",method:"alphabetic",length:4};var a=$.extend(b,a);return this.each(function(){function p(){a.type=e[Math.floor(Math.random()*e.length)];a.method="random"}function q(){if(a.type=="text"){a.method=f[Math.floor(Math.random()*f.length)]}else{a.method=g[Math.floor(Math.random()*g.length)]}}function r(){if(a.type=="text"){for(i=0;i<a.length;i++){j+=b[Math.floor(Math.random()*b.length)]}}else{h=d[a.method];k=c[Math.floor(Math.random()*c.length)];l=c[Math.floor(Math.random()*c.length)];j=k+" "+h+" "+l}}function s(b){var c='<p><span id="type_captcha_method">'+n+'</span>: <span id="captcha">'+j+"</span></p>";c+='<input type="text" id="captcha_user" name="captcha_user" />';c+='<input type="hidden" id="captcha_type" name="captcha_type" value="'+a.type+'" />';c+='<input type="hidden" id="captcha_method" name="captcha_method" value="'+a.method+'" />';c+='<input type="hidden" id="captcha_value" name="captcha_value" value="'+j+'" />';b.children(":submit").before(c)}function t(){if($.inArray(a.method,o)<0){log("Type, method mismatch. \n type: "+a.type+" \n method: "+a.method);return false}}var b=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];var c=[0,1,2,3,4,5,6,7,8,9];var d={add:"+",multiply:"*"};var e=["text","number"];var f=["backwards","alphabetic","reverse_alphabetic"];var g=["add","multiply"];var h="";var j="",k,l,m;var n;if(a.type=="random"){p()}var o;if(a.type=="text"){o=f}else{o=g}if(a.method=="random"){q()}r();t();switch(a.method){case"backwards":n="Type this string backwards";break;case"alphabetic":n="Type this string in alphabetical order";break;case"reverse_alphabetic":n="Type this string in reverse alphabetical order";break;case"add":n="Add these numbers";break;case"multiply":n="Multiply these numbers";break}s($(this))})};$.fn.textCaptchaCheck=function(){var value,correct_value="",captcha_type=$("#captcha_type").val(),captcha_method=$("#captcha_method").val(),captcha_user=$("#captcha_user").val();if(captcha_type=="text"){value=$("#captcha_value").val().split("")}else{value=$("#captcha_value").val()}switch(captcha_method){case"alphabetic":value=value.sort();break;case"backwards":value=value.reverse();break;case"reverse_alphabetic":value=value.sort();value=value.reverse();break;case"add":value=eval(value);break;case"multiply":value=eval(value);break}if(captcha_type=="text"){correct_value=value.join("")}else{correct_value=value}log("value: "+value+" correct_value: "+correct_value);if(captcha_user!=correct_value){return false}else{return true}}})(jQuery)